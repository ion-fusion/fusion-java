// Copyright (c) 2013-2016 Amazon.com, Inc.  All rights reserved.

(require
  "/fusion/experimental/check"
  "/fusion/experimental/string"
  "/fusion/list"
  "/fusion/string")


// Here's the bindings we expect to be available:
(module check_bindings '/fusion/string'
  [ is_string,
    string_append, string_to_lower, string_to_symbol, string_to_upper,
  ])


//============================================================================
// Comparisons

(define_check (check_comparisons lo hi)
//  (check <  lo hi)  TODO FUSION-243 string ordering
//  (check <= lo hi)
  (check =  lo lo)
  (check =  hi hi)
//  (check >= hi lo)
//  (check >  hi lo)
)

(check_comparisons ""  "a")
(check_comparisons "a" "b")

(check_comparisons (quote f::"" ) (quote e::"a"))
(check_comparisons (quote f::"a") (quote e::"b"))


//============================================================================
// string_append

(check === ""    (string_append ""   ""))
(check === "aB"  (string_append "aB" ""))
(check === "aBc" (string_append "aB" "c"))

(check === "aBcd" (string_append "aB" (quote c) "d"))
(check === "aB"   (string_append (quote aB) ""))
(check === "aBc"  (string_append (quote aB) "c"))
(check === "aBcd" (string_append (quote aB) "c" (quote d)))


(expect_argument_exn (string_append (void)))
(expect_argument_exn (string_append null))
(expect_argument_exn (string_append null.string))

(expect_argument_exn (string_append (void) "anything"))
(expect_argument_exn (string_append null "anything"))
(expect_argument_exn (string_append null.string "anything"))

(expect_argument_exn (string_append "anything" (void)))
(expect_argument_exn (string_append "anything" null))
(expect_argument_exn (string_append "anything" null.string))


//============================================================================
// string_to_lower, string_to_upper

(check === ""    (string_to_lower ""))
(check === "abc" (string_to_lower "AbC"))


(check === ""    (string_to_upper ""))
(check === "ABC" (string_to_upper "AbC"))


//============================================================================
// string_to_symbol

(check === (quote null.symbol) (string_to_symbol null.string))
(check === (quote text)        (string_to_symbol "text"))

// TODO FUSION-204 support empty symbol
(expect_argument_exn (string_to_symbol ""))


//============================================================================
// symbol_to_string

(check === null.string (symbol_to_string (quote null.symbol)))
(check === "text"      (symbol_to_string (quote text)))

// TODO FUSION-204 support empty symbol
