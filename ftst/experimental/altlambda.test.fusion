// Copyright (c) 2012-2014 Amazon.com, Inc.  All rights reserved.

(require
  "/fusion/experimental/altlambda"
  "/fusion/experimental/check"
  "/fusion/experimental/syntax")

(define sub1
  (|x| (- x 1)))
(check === 1 (sub1 2))

(define_syntax dont_capture_pipe
  (lambda (stx)
    (let ((name (syntax_get stx 1))
          (body (syntax_get stx 2)))
      (quasisyntax
        (| (unsyntax name) | (unsyntax body))))))
(define pipearg
  (let ((| "dummy"))  // Ensure a different binding for | than the global
    (dont_capture_pipe | (+ | 2))))
(check === 2 (pipearg 0))
