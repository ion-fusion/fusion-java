// Copyright (c) 2013 Amazon.com, Inc.  All rights reserved.

(require
  "/check"
  "/fusion/string")


// Here's the bindings we expect to be available:
(module check_bindings '/fusion/string'
  [ is_string,
    string_append, string_to_lower, string_to_symbol, string_to_upper,
  ])


(check = (string_append ""   "")  "")
(check = (string_append "aB" "")  "aB")
(check = (string_append "aB" "c") "aBc")

(check = (string_append "aB" (quote c) "d") "aBcd")
(check = (string_append (quote aB) "") "aB")
(check = (string_append (quote aB) "c") "aBc")
(check = (string_append (quote aB) "c" (quote d)) "aBcd")


(check = (string_to_lower "")    "")
(check = (string_to_lower "AbC") "abc")


(check = (string_to_upper "")    "")
(check = (string_to_upper "AbC") "ABC")


//============================================================================
// string_to_symbol

(check ion_equals (string_to_symbol null.string) (quote null.symbol))
(check = (string_to_symbol "text") (quote text))

(check_arg_exn (string_to_symbol ""))
